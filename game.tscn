[gd_scene format=3 uid="uid://cltoc1fobd4yx"]

[ext_resource type="Script" uid="uid://b32i8mqgc8vrr" path="res://game.gd" id="1_80nbo"]
[ext_resource type="PackedScene" uid="uid://dji7tytceexa3" path="res://movement_test/character_run.tscn" id="2_feb5d"]
[ext_resource type="Script" uid="uid://fem0shj6kr8h" path="res://camera.gd" id="3_eow3j"]
[ext_resource type="PackedScene" uid="uid://c3xyum43h7j3r" path="res://pages/page1_test.tscn" id="3_fc0e3"]
[ext_resource type="PackedScene" uid="uid://qa47f04qccbp" path="res://pages/page2_test.tscn" id="4_7jktm"]
[ext_resource type="Script" path="res://target_animation.gd" id="4_j5wjh"]
[ext_resource type="Script" path="res://target_animation_config.gd" id="5_j5wjh"]
[ext_resource type="PackedScene" uid="uid://dkcbw3cmj3bv3" path="res://models/pushpin.tscn" id="6_ryrav"]
[ext_resource type="Script" uid="uid://btf4vy1tqv2el" path="res://models/pushpin_managers.gd" id="9_hve3p"]
[ext_resource type="AudioStream" uid="uid://coqy6et1rom4g" path="res://music/groovy picture book combined.mp3" id="10_hve3p"]
[ext_resource type="Texture2D" uid="uid://bbdjy2kx388np" path="res://UI/pushpin.png" id="11_mfdv2"]
[ext_resource type="PackedScene" uid="uid://cs6iqsbiq7ea1" path="res://models/edge.tscn" id="12_iotsf"]
[ext_resource type="PackedScene" uid="uid://dqgwr5x53ceba" path="res://models/table.tscn" id="12_lc2xo"]
[ext_resource type="PackedScene" uid="uid://bm4axdvvf7pmb" path="res://models/book_cover.tscn" id="14_215e1"]

[sub_resource type="Resource" id="Resource_vef74"]
script = ExtResource("5_j5wjh")
damping_constant = 50.0

[sub_resource type="Resource" id="Resource_j5wjh"]
script = ExtResource("5_j5wjh")
spring_constant = 250.0
damping_constant = 50.0

[sub_resource type="GDScript" id="GDScript_hve3p"]
script/source = "extends Node3D

@export var page_scenes: Array[PackedScene] = []

func _ready() -> void:
	for page_scene in page_scenes:
		var page_3d: Page3D = preload(\"res://page3d.tscn\").instantiate()
		page_3d.page_scene = page_scene
		add_child(page_3d)
		
		if !page_3d.is_node_ready(): await page_3d.ready
		var page := page_3d.page
		var outline_projector := preload(\"res://outline_projector.tscn\").instantiate()
		outline_projector.origin_node = %PageProjectorOrigin
		outline_projector.page = page
		add_child(outline_projector)
		
		get_parent().active_page_changed.connect(
			func(active_page: Page):
				var active_page_index: int = get_parent().active_page_index
				var page_index: int = get_parent().index_of_page(page)
				if page_index == active_page_index - 1:
					outline_projector.start_casting()
				else:
					outline_projector.stop_casting()
		)
"

[sub_resource type="LabelSettings" id="LabelSettings_215e1"]
font_size = 128
shadow_size = 32
shadow_color = Color(0, 0, 0, 1)

[sub_resource type="LabelSettings" id="LabelSettings_7sc4i"]
font_size = 64
shadow_size = 32
shadow_color = Color(0, 0, 0, 1)

[sub_resource type="LabelSettings" id="LabelSettings_80cx4"]
font_size = 64
shadow_size = 32
shadow_color = Color(0, 0, 0, 1)

[node name="Game" type="Node3D" unique_id=519886471 node_paths=PackedStringArray("book_cover", "pushpin_manager", "start_text", "end_text")]
script = ExtResource("1_80nbo")
book_cover = NodePath("book_cover")
pushpin_manager = NodePath("pushpin_manager")
start_text = NodePath("Control/Title_text")
end_text = NodePath("Control/End_text")

[node name="PlayerSprite" type="Sprite3D" parent="." unique_id=843110985]
unique_name_in_owner = true
transform = Transform3D(0.1, 0, 0, 0, 0.1, 0, 0, 0, 0.1, 0.675, -0.347, 0.01)

[node name="character_run" parent="PlayerSprite" unique_id=1773396158 instance=ExtResource("2_feb5d")]
transform = Transform3D(-5.2453664e-09, 0, 0.12, 0, 0.12, 0, -0.12, 0, -5.2453664e-09, 0, 0, 0)

[node name="Camera3D" type="Camera3D" parent="." unique_id=10132499 node_paths=PackedStringArray("main_menu_target", "game_target", "book_cover")]
transform = Transform3D(1, 0, 0, 0, 0.9837067, 0.1797809, 0, -0.1797809, 0.9837067, 0, 0.4850288, 2.091046)
current = true
fov = 22.3
size = 1.3631029
script = ExtResource("3_eow3j")
main_menu_target = NodePath("../camera_target_main_menu")
game_target = NodePath("../camera_target_game")
book_cover = NodePath("../book_cover")

[node name="XTargetAnimation" type="Node" parent="Camera3D" unique_id=931201905]
script = ExtResource("4_j5wjh")
config = SubResource("Resource_vef74")

[node name="YTargetAnimation" type="Node" parent="Camera3D" unique_id=753444433]
script = ExtResource("4_j5wjh")
config = SubResource("Resource_j5wjh")

[node name="OmniLight3D" type="OmniLight3D" parent="Camera3D" unique_id=890012083]
transform = Transform3D(1, 0, 0, 0, 0.9837066, -0.17978089, 0, 0.17978089, 0.9837066, 1.0337287, -0.35662395, -0.4066228)

[node name="camera_target_main_menu" type="Node3D" parent="." unique_id=1427334286]
transform = Transform3D(0.38641727, -8.637098e-09, -0.10335228, -0.045570742, 0.3590173, -0.17038159, 0.09276315, 0.17637055, 0.34682623, -3.3523831, -5.1201286, 8.639566)

[node name="camera_target_game" type="Node3D" parent="." unique_id=1299318887]
transform = Transform3D(0.40000004, 0, 0, 0, 0.3934286, 0.07220766, 0, -0.07220766, 0.3934286, 0.99, -0.2, 2.091)

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="." unique_id=2073432316]
transform = Transform3D(0.9114464, 0.32436162, -0.253091, -0.29250705, 0.94348896, 0.15578246, 0.2893184, -0.06795648, 0.95481765, 0, 0, 0)
shadow_enabled = true

[node name="Pages" type="Node3D" parent="." unique_id=1936395579]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.96, -0.54, 0)
script = SubResource("GDScript_hve3p")
page_scenes = Array[PackedScene]([ExtResource("3_fc0e3"), ExtResource("4_7jktm")])

[node name="pushpin_manager" type="Node3D" parent="." unique_id=1200090941 node_paths=PackedStringArray("pins", "ui_pins", "player", "edge_obj", "game_node")]
script = ExtResource("9_hve3p")
pins = [NodePath("pushpin"), null, NodePath("pushpin3")]
pickup_dist = 0.1
ui_pins = [NodePath("../Control/pushpin_ui_control/ui_pushpin"), NodePath("../Control/pushpin_ui_control/ui_pushpin2"), NodePath("../Control/pushpin_ui_control/ui_pushpin3"), NodePath("../Control/pushpin_ui_control/ui_pushpin4"), NodePath("../Control/pushpin_ui_control/ui_pushpin5"), NodePath("../Control/pushpin_ui_control/ui_pushpin6"), NodePath("../Control/pushpin_ui_control/ui_pushpin7"), NodePath("../Control/pushpin_ui_control/ui_pushpin8"), NodePath("../Control/pushpin_ui_control/ui_pushpin9"), NodePath("../Control/pushpin_ui_control/ui_pushpin10")]
player = NodePath("../PlayerSprite")
edge_obj = NodePath("../edge")
edge_obj_dist = 0.3
game_node = NodePath("..")

[node name="pushpin" parent="pushpin_manager" unique_id=65536298 node_paths=PackedStringArray("player") instance=ExtResource("6_ryrav")]
transform = Transform3D(0.02, 0, 0, 0, -8.7422775e-10, -0.02, 0, 0.02, -8.7422775e-10, 1.2349168, -0.51593393, 0.051739097)
player = NodePath("../../PlayerSprite")

[node name="pushpin3" parent="pushpin_manager" unique_id=285274198 node_paths=PackedStringArray("player") instance=ExtResource("6_ryrav")]
transform = Transform3D(0.02, 0, 0, 0, -8.7422775e-10, -0.02, 0, 0.02, -8.7422775e-10, 1.6406991, -0.6446243, 0.051738977)
player = NodePath("../../PlayerSprite")

[node name="AudioStreamPlayer" type="AudioStreamPlayer" parent="." unique_id=1033802842]
stream = ExtResource("10_hve3p")
volume_db = -12.0
autoplay = true

[node name="Control" type="Control" parent="." unique_id=1775790728]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
size_flags_horizontal = 3
size_flags_vertical = 3

[node name="pushpin_ui_control" type="Control" parent="Control" unique_id=1951991676]
anchors_preset = 0
offset_left = 1924.0
offset_right = 1964.0
offset_bottom = 40.0

[node name="ui_pushpin" type="TextureRect" parent="Control/pushpin_ui_control" unique_id=1117308562]
layout_mode = 0
offset_left = -121.0
offset_top = 29.0
offset_right = -21.0
offset_bottom = 129.0
texture = ExtResource("11_mfdv2")
expand_mode = 1

[node name="ui_pushpin2" type="TextureRect" parent="Control/pushpin_ui_control" unique_id=5822654]
layout_mode = 0
offset_left = -241.0
offset_top = 29.0
offset_right = -141.0
offset_bottom = 129.0
texture = ExtResource("11_mfdv2")
expand_mode = 1

[node name="ui_pushpin3" type="TextureRect" parent="Control/pushpin_ui_control" unique_id=1705446292]
layout_mode = 0
offset_left = -361.0
offset_top = 29.0
offset_right = -261.0
offset_bottom = 129.0
texture = ExtResource("11_mfdv2")
expand_mode = 1

[node name="ui_pushpin4" type="TextureRect" parent="Control/pushpin_ui_control" unique_id=543431149]
layout_mode = 0
offset_left = -481.0
offset_top = 29.0
offset_right = -381.0
offset_bottom = 129.0
texture = ExtResource("11_mfdv2")
expand_mode = 1

[node name="ui_pushpin5" type="TextureRect" parent="Control/pushpin_ui_control" unique_id=916079887]
layout_mode = 0
offset_left = -601.0
offset_top = 29.0
offset_right = -501.0
offset_bottom = 129.0
texture = ExtResource("11_mfdv2")
expand_mode = 1

[node name="ui_pushpin6" type="TextureRect" parent="Control/pushpin_ui_control" unique_id=566233657]
layout_mode = 0
offset_left = -721.0
offset_top = 29.0
offset_right = -621.0
offset_bottom = 129.0
texture = ExtResource("11_mfdv2")
expand_mode = 1

[node name="ui_pushpin7" type="TextureRect" parent="Control/pushpin_ui_control" unique_id=1625469636]
layout_mode = 0
offset_left = -841.0
offset_top = 29.0
offset_right = -741.0
offset_bottom = 129.0
texture = ExtResource("11_mfdv2")
expand_mode = 1

[node name="ui_pushpin8" type="TextureRect" parent="Control/pushpin_ui_control" unique_id=1982600288]
layout_mode = 0
offset_left = -961.0
offset_top = 29.0
offset_right = -861.0
offset_bottom = 129.0
texture = ExtResource("11_mfdv2")
expand_mode = 1

[node name="ui_pushpin9" type="TextureRect" parent="Control/pushpin_ui_control" unique_id=383953143]
layout_mode = 0
offset_left = -1081.0
offset_top = 29.0
offset_right = -981.0
offset_bottom = 129.0
texture = ExtResource("11_mfdv2")
expand_mode = 1

[node name="ui_pushpin10" type="TextureRect" parent="Control/pushpin_ui_control" unique_id=646933080]
layout_mode = 0
offset_left = -1201.0
offset_top = 29.0
offset_right = -1101.0
offset_bottom = 129.0
texture = ExtResource("11_mfdv2")
expand_mode = 1

[node name="Title_text" type="Control" parent="Control" unique_id=1116676485]
anchors_preset = 0
offset_right = 40.0
offset_bottom = 40.0

[node name="Label" type="Label" parent="Control/Title_text" unique_id=1179563331]
layout_mode = 0
offset_left = 83.0
offset_top = 230.0
offset_right = 826.0
offset_bottom = 761.0
text = "Groovy 
     Picture 
             Book"
label_settings = SubResource("LabelSettings_215e1")

[node name="Label2" type="Label" parent="Control/Title_text" unique_id=376699993]
layout_mode = 0
offset_left = 188.0
offset_top = 815.0
offset_right = 931.0
offset_bottom = 1346.0
text = "~Press Space to begin~"
label_settings = SubResource("LabelSettings_7sc4i")

[node name="End_text" type="Control" parent="Control" unique_id=796613667]
visible = false
anchors_preset = 0
offset_right = 40.0
offset_bottom = 40.0

[node name="Label" type="Label" parent="Control/End_text" unique_id=176878966]
layout_mode = 0
offset_left = 218.0
offset_top = 434.0
offset_right = 961.0
offset_bottom = 965.0
text = "You Win!"
label_settings = SubResource("LabelSettings_215e1")

[node name="Label" type="Label" parent="Control/End_text/Label" unique_id=1883928395]
layout_mode = 0
offset_left = -28.0
offset_top = 201.0
offset_right = 715.0
offset_bottom = 732.0
text = "Thanks for playing!"
label_settings = SubResource("LabelSettings_80cx4")

[node name="PageProjectorOrigin" type="Node3D" parent="." unique_id=1276404290]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.96, -0.54, 5)

[node name="table" parent="." unique_id=358082385 instance=ExtResource("12_lc2xo")]
transform = Transform3D(-5.6087842e-08, -6.70589e-08, -2, -1.5341287, 1.2831402, 0, 1.2831402, 1.5341287, -8.742278e-08, 1.5245993, -0.8687203, -1.0681267)

[node name="edge" parent="." unique_id=2082557506 instance=ExtResource("12_iotsf")]
transform = Transform3D(0.1, 0, 0, 0, 0.1, 0, 0, 0, 0.1, 1.8549298, -0.6, 0)

[node name="book_cover" parent="." unique_id=853065262 instance=ExtResource("14_215e1")]
transform = Transform3D(0.4, 0, 0, 0, -1.7484556e-08, -0.4, 0, 0.4, -1.7484556e-08, -0.14961612, -0.5890209, -0.08410567)
